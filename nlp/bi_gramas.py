import re 
import nltk 
from nltk.corpus import stopwords
from nltk.collocations import *
import configparser
nltk.download('stopwords')
def extraer_bi_gramas(texto):
    salida = tokenizar(texto)
    i = 0
    while (i < 10):
        salida = limpiar_stop_words(salida)
        i = i + 1
    salida = bi_gramas(salida)
    return salida

def tokenizar(texto):
    texto = texto.lower()
    texto = texto.strip()
    plantilla = r"[\W\t\n]+"
    salida =re.split(plantilla,texto)
    for palabra in salida:
        if palabra in [" ",".",",",""]:
            salida.remove(palabra)
    return salida

def limpiar_stop_words(texto):
    config = configparser.ConfigParser()
    config.sections()
    config.read("/home/jaime/cosas/codigo/trabajo-minciencias/general.cfg")
    palabras = config["stop_words"]["palabras"]
    stops_personalizadas = palabras.split(",")
    stops = stopwords.words("spanish")
    for word in texto:
        if word in stops or word in stops_personalizadas or len(word) == 1:
            texto.remove(word)
    return texto

def bi_gramas(texto): 
    salida = list(nltk.bigrams(texto))
    dist_frequencia = nltk.FreqDist(salida)
    return dist_frequencia.most_common(50)

def extraer_colocaciones(texto):
    medida_bigramas = nltk.collocations.BigramAssocMeasures()
    buscador = BigramCollocationFinder.from_words(texto)
    #buscador.apply_freq_filter(3)
    return buscador.nbest(medida_bigramas.pmi,15)
#a = tokenizar("En Colombia existen 7.7 millones de afectados porla violencia y el conflicto armado, de las cuales la mayoría han sido afectadas por grupos guerrilleros, paramilitares y bandas criminales, también se reporta un porcentaje significativo de ciudadanos a quienes la fuerza pública y el Estado les han violado parte de sus derechos. Algunas víctimas de la violencia sexual hacen parte de este grupo. La Red Nacional de Información (RNI) estima que al menos 13.598 personas han padecido delitos contra la libertad e integridad sexual. De ellas, 12.182 son mujeres (aproximadamente un 90% de los afectados); 1.067, hombres; y 71 personas con orientación sexual o identidad de género no hegemónica (comunidad Lgtbi). Para el caso de Santander, según la Unidad para la Atención y Reparación Integral a las Víctimas (Uariv), se cuenta con un registro de 353 víctimas reconocidas. La mayoría son mujeres. Patricia* es una de ella. No solo busca reparación integral por los hechos que narra a continuación. Asegura que las heridas dejadas por un arma de fuego no se comparan con las que una violación deja en la mente y el cuerpo de una persona. Víctimas de la violencia sexual, la otra cara del conflicto armado en la región El Periódico 15 conoció su historia. Alejada de su pasado y aún superando sus trágicas vivencias, hoy día integra el grupo de 25 mujeres que participan en los encuentros organizados en Bucaramanga por la Uariv de Santander conocidos como “Momentos”, con los cuales se busca “fortalecer la confianza en sí mismas y que exista un reconocimiento y acompañamiento para superar las dolorosas huellas del conflicto armado en su cuerpo”, aseguró Paula Gaviria Betancur, directora de la Unidad. Mientras pasea por su huerta y mira el paisaje, Patricia ubica dos sillas debajo de un árbol de mango para narrar su experiencia. Lo primero que cuenta es que proviene de una familia trabajadora que se asentó en el municipio de Piedecuesta hace más de 30 años. Allí terminó sus estudios como bachiller contable, en la misma época en la que su papá trabajaba como soldador industrial de profesión en el corregimiento de San Rafael de Lebrija, del municipio de Rionegro, Santander, y en la que decidió que toda la familia se debía trasladar allí, pero la joven se quedó. Pasados algunos meses Patricia se enamoró y quedó embarazada. Esto la llevó a dedicarse a su hogar y no pensar en un trabajo distinto que edificar su nuevo hogar. Cuando se aproximaba la fecha del nacimiento de su hija, ella optó por trasladarse a la tierra donde habitaban sus padres. Fue allí donde conoció por primera vez la violencia que vivía la Colombia de los años 90. Cuenta que mientras conversaba con un amigo en el andén de su casa, de repente se fue la luz; segundos después, hombres armados se acercaron a ese lugar, donde luego de un cruce de palabras entre ellos sobre la integridad de la joven embarazada, optaron por abrir la puerta de su casa y empujarla hacia adentro, para después acribillar a su compañero de charla. Ella, en estado de shock, se levantó de aquel lugar y corrió hacia el cuerpo que yacía tirado en un charco de sangre. Patricia no lo podía creer, agarró el cuerpo de su amigo y lo recostó, momento exacto en el que llegó la luz, no solo para dar claridad al pueblo, sino también para mostrar la realidad de este hecho violento, que hasta el momento no se lograba comprender por causa de la conmoción que visitaba a las personas del sector. Recuerda que su padre, al verla bañada en sangre, corrió y le desgarró la ropa para cubrir las heridas en su cuerpo, pero por fortuna estaba ilesa. La alegría que le produjo la llegada de su hija dejó de lado aquel fatídico momento. La niña nació y creció con una alegría y espontaneidad que la caracterizaba como una persona llena de sueños e ilusiones. Se alejaron de Rionegro y se radicaron en Arauca, donde madre e hija transitaban diariamente las decenas de hectáreas de cultivos de arroz. Mientras tanto, la región de Santander donde vivían sus padres era invadida por grupos paramilitares que atrozmente asesinaban y luego desmembraban los cuerpos de sus víctimas. Este flagelo visitó a una familia cercana a su hogar, dos de sus integrantes habían sido descuartizados. La noticia asombró y alarmó a Patricia, y pensó en la integridad de sus padres y hermanos. Este grupo armado ilegal conoció de la existencia de un soldador industrial en la zona, persona que podía servirles para el rompimiento del oleoducto de petróleo que pasaban por aquel lugar, negocio que era rentable para financiar sus delitos. Infortunadamente este soldador era el padre de Patricia, quien se negó a realizar aquellos trabajos. Esto desató la ira en su contra al no realizar dichos favores. Una noche, mientras esposos e hijos dormían, hombres armados llegaron a exigir la realización del trabajo. Asustados por las amenazas, guardaron silencio. Los paramilitares pensaron que la casa estaba sola, se montaron a un tractor, tumbaron el portón y rompieron la pared. De esa forma les dieron a conocer su descontento por no colaborar en lo que les pedían. Al conocer lo ocurrido, Patricia, con cuatro meses de embarazo de su segundo hijo, con una niña de 5 años y su chofer, decidió volver al lado de sus seres queridos. En el lugar tomó la camioneta de su propiedad, con la intención de ir a rescatar algunos de los enseres y maquinarias de trabajo de su padre. Después de lograr su objetivo, regresó a Arauca no solo en compañía de su niña y su chofer, sino también la de su hermano. En su viaje a Arauca, se detuvieron en Saravena con la intención de retirar algún dinero del cajero para poder hospedarse en un hotel y continuar el viaje al otro día. La tarjeta de crédito no funcionó. Pidieron colaboración en un hotel de la zona con la condición de que al otro día pagarían, pero el administrador no aceptó hospedarlos. A partir de este momento, debajo del follaje del árbol de mango y teniendo como panorámica el municipio de Piedecuesta, la actitud de Patricia cambió. Al parecer, los recuerdos le bombardeaban la mente y los sentimientos de dolor empezaron a relucir. Sin embargo, retomó la historia de Saravena. Recordó que en el municipio de Arauquita, a 58 kilómetros de aquel lugar, vivía una amiga de la familia que podía darles hospedaje. “Fue la peor decisión de mi vida”, expresó con un dolor notable en su rostro. Partieron a las 8:00 de la noche cuando de repente se encontraron un retén militar. “Necesitamos que lleven a dos soldados hasta allí adelante”, afirmó uno de los soldados. Patricia respondió: “no podemos llevarlos, mire que vamos llenos y no tenemos donde acomodarlos”. Después de un cruce de palabras, la Fuerza Pública permitió que continuara su camino. Pensando los ocupantes del vehículo que ya todo había pasado, una barricada estaba preparada metros más adelante, lo cual provocó de nuevo la detención del carro. “Tienen que llevarlos”, ordenaron los soldados. De esta manera y prácticamente obligados embarcaron como pudieron a los dos hombres en la camioneta. Dos kilómetros más adelante, uno de los uniformados mandó a detener el carro y se escuchó a uno de ellos decir: “Váyanse ustedes, pero la señora y la niña se quedan con nosotros”. Los hombres que viajaban con esta mujer reaccionaron negativamente a esta petición, palabras de todo tipo se cruzaban entre los civiles y los militares. Finalmente, sin entender nada de lo que estaban viviendo, recapacitó y dijo: “váyanse ustedes, yo me quedo sola, pero mi hija también se va”, petición que no fue aceptada por los miembros del ejército. Después de un forcejeo y de algunos golpes al tío de la niña, la mujer y su hija tuvieron que quedarse. Fueron llevadas a una construcción que se levantaba al lado de la carretera. Uno de los militares, de piel blanca como lo describe Patricia, le gritó, insinuándole que por ser una guerrillera era que estaba allí.")
#a = tokenizar("Este proyecto corresponde a la crónicas escritas por los estudiantes del programa de Comunicación Social - Periodismo Una flota Macarena —quizá única empresa transportadora que va hacia al Guaviare— levantaba el polvo anaranjado de aquellos pedazos de la carretera que a los contratistas les dio por no asfaltar. Grande, vieja y ruidosa pasaba por delante de todos con afán, el conductor probablemente quiso ser piloto de fórmula uno en su pubertad. En el tramo de Puerto Lleras - Puerto Concordia, al costado derecho, el río Ariari se comía la carretera que va hasta San José del Guaviare. Varios metros ahora son parte del río, una extensión más de aquel vasto y afanado caudal. En comparación a las décadas pasadas ese es el menor de los problemas, hace 15 o 20 años los que se tomaban las carreteras eran los grupos guerrilleros: reclutaban niños, pedían dinero a los campesinos por transportar sus cultivos o mercancía hacia Villavicencio y despojaban violentamente las pertenencias de la gente del campo. Al llegar a San José se nota que es de esos lugares donde se desconoce cualquier símbolo de alegría o sabor que dice tener nuestro país. Para desconocer Colombia hay que viajar al sur. Es allí, donde la coca y la nostalgia son amigas de toda persona. —Antes de llegar la coca, esto era muy bueno, todo era muy sano. Este pueblito aquí usted se miraba y era lleno de comida, por decir, eso eran arrumes de maíz, arrumes de arroz, sí. Eso usted miraba aquí en ese puerto hoy día cantidad de marranos y gallinas. Uriel vive a 60 metros del río Guaviare y lleva 50 años en San José. Tiene una tienda donde casi no entra luz, pero al fondo se nota que existe un pequeño hogar. El lugar al igual que todo el pueblo, está cubierto por una arena rojiza, afuera tiene una mesa plástica de color azul en la que me habla de todo. —Aquí el que olía a paraco lo mataban los guerrillos y el que olía a guerrillo lo mataban los paracos, la misma chanda pero con distinto nombre. Decía jocosamente Uriel hasta el momento en el que llegaron unos soldados y el ambiente se tornó incómodo, seguramente ese hombre aún tiene que olvidarse de cosas que nadie más debe saber. San José ahora es un pueblo que busca la paz después de la coca. Toda su gente tuvo una relación con los cultivos de coca. Llegaban a finales de los 50, buscando suerte tal y como lo hizo Fernando. —Me fui a probar suerte al Guaviare, a ver cómo era eso, me fui con toda, a probar suerte. Fernando con 22 años salió de la finca de sus padres en Santa María al sur de Boyacá para intentar ganarse la vida cultivando coca que era lo que daba dinero en aquellos años. Dejó atrás a sus padres y a sus cuatro hermanos, pero al llegar al Guaviare se sorprendió —Todo lo que uno cercaba era de uno, yo trabajaba día y noche, para agarrar todo lo que pudiera. Él se hizo una finca con 250 hectáreas donde cultivó coca, plátano, yuca y tuvo una que otra cabeza de res en su poder. Pasados los años al ver el éxito de los cultivos que le dejaban ganancias cuyo valor no se atrevió a mencionar, sus familiares sobre todo sus hermanos llegaron a su finca a trabajarle como raspachines —el que raspa la hoja de coca—. Sin embargo, perdería sus tierras víctima de amenazas —No faltaron los comentarios de la gente, me metieron en cuentos, en chismes entonces, pues todo eso la güerilla se llenó de motivos. Me robaron todo mi trabajo y perdí los 10 años de trabajo, me tocó salirme de por allá. 1992 es un año que recuerda de mal manera, fue el año en que lo perdió todo. En la década de los 80 ́, las Farc tenían el control de la gente y sus cultivos, de lo que producían, del que entraba a las fincas y de quien salía. Los cultivos de coca eran el eje de poder en cuanto al narcotráfico de las Farc, pero única manera de vivir para muchos campesinos. —Para mí fue una pesadilla, el que aprovechó aprovechó, aquí yo sé que hay mucha gente que aprovechó los momentos y tiene su negocito y otra gente que no supo. Dice Hernán, un vendedor de dulces en el parque principal de San José sobre lo que fue la coca en su vida, en el pasado fue un raspachín en Lindosa (Guaviare) y trabajó como raspachín hasta que le dio trombosis en su pierna izquierda. La coca cambió la vida de las personas de manera drástica o quizá de manera absoluta como a Fernando. Fernando fue acusado de ayudar al Ejército hasta que llegó el día en que un amigo cercano le dijo: “Hermano váyase porque a usted lo van a matar”. — Ese día lo primero que hice, fue coger mis chiros y arrancar para Villavicencio, y luego me enteré que al otro día fueron a matarme a mí, porque a mis hermanos no les hicieron nada. Él ahora tiene 57 años, de tez morena, sus manos tienen callos y esos callos también tienen callos, sus ojos están desvanecidos, su cara tiene arrugas indicio de jornadas de cara al sol durante años y el alma un poco apagada, seguramente resultado de noches trabajando para tener que comer al otro día. Es alto, viste de gorra, pantalón negro y la camisa que le plazca ponerse. Ese día Fernando estaba pescando en el río unas cuchas para el caldo de la noche, ya llevaba tres y parecía que no habría más ese día ni para ningún otro día. De camino a la casona de finca se encontró con un amigo cercano a él, que le dio la noticia, de inmediato llegó y sin decir ni un soplo se llevó los primeros trapos que veía, se internó en el monte para después caminar hasta un lugar seguro más allá de Puerto Lleras. —Una vez en Villavicencio... Interrumpe su historia, se levanta y es en ese momento donde él se pregunta y me pregunta: — ¿el Estado qué? El Estado eso por allá no se veía. De vez en cuando se veía el Ejército, muy de vez en cuando. Hace 20 años la guerrilla era una gente muy pobre, ahora es la gente más rica porque se benefician del narcotráfico, de la coca, ellos son los que la compran, los que la venden, ellos son los que también se la huelen mejor dicho. Hechos como estos dejaron en la mente de los Guaviarenses una imagen negativa sobre el proceso de paz. — Yo no creo en eso porque esa gente tiene mucha plata y les da lástima perder todo lo que tienen. Yo no creo en eso y no creo. Fernando víctima del conflicto, cocalero por convicción, pero obrero por obligación y soñador por evangelio, es uno de tantos colombianos que esperan que la situación cambie. La coca se convirtió en el demonio que acecha su vida, porque no hay noche en la que no duerma con un ojo abierto, pues siempre siente el temor de que en cualquier momento le arrebaten su vida. —El gobierno no hace sino decir “fumiguen y arranquen” pero no piensan que hay que comer, que los hijos tienen que comer, que tomar aguapanela, mire nomás a los niños que se enfermaban con el veneno ese que echaban. Eso es lo único bueno que ha hecho el gobierno poner a las familias a aguantar hambre. Fernando ahora tiene esperanza en las esmeraldas, en que trabajando como minero en Boyacá puede recuperar todo lo que perdió hace más de dos décadas. Mientras finaliza toda su historia, saca de sus bolsillos unas chispas de esmeralda, mientras sus ojos se empañaban y su voz se apagaba. Esa fue su primera conversación y quizá la última sobre un país en donde aún existen lugares donde la paz se tarda en llegar.")
b = limpiar_stop_words(a)
c = limpiar_stop_words(b)
d = limpiar_stop_words(c)
e = limpiar_stop_words(d)
ejemplo = bi_gramas(d)
print(ejemplo)
print(extraer_colocaciones(e))

